<ng-container *ngIf="isAuthPage; else mainLayout">
  <router-outlet></router-outlet>
</ng-container>

<ng-template #mainLayout>
  <div class="app-container">
    <aside class="sidebar">
      <div class="sidebar-header">Garage Management</div>
      <nav class="sidebar-nav">
        <a routerLink="/dashboard" routerLinkActive="active" class="nav-item">Dashboard</a>
        
        <ng-container *ngIf="hasModule('CUSTOMERS')">
          <div class="nav-section">Customers</div>
          <a routerLink="/companies" routerLinkActive="active" class="nav-item">Companies</a>
          <a routerLink="/clients" routerLinkActive="active" class="nav-item">Clients</a>
          <a routerLink="/vehicles" routerLinkActive="active" class="nav-item">Vehicles</a>
        </ng-container>
        
        <ng-container *ngIf="hasModule('INVENTORY')">
          <div class="nav-section">Inventory</div>
          <a routerLink="/suppliers" routerLinkActive="active" class="nav-item">Suppliers</a>
          <a routerLink="/categories" routerLinkActive="active" class="nav-item">Categories</a>
          <a routerLink="/products" routerLinkActive="active" class="nav-item">Products</a>
          <a routerLink="/services" routerLinkActive="active" class="nav-item">Services</a>
        </ng-container>
        
        <ng-container *ngIf="hasModule('OPERATIONS')">
          <div class="nav-section">Operations</div>
          <a routerLink="/supplier-orders" routerLinkActive="active" class="nav-item">Supplier Orders</a>
          <a routerLink="/inventory" routerLinkActive="active" class="nav-item">Stock Management</a>
          <a routerLink="/work-orders" routerLinkActive="active" class="nav-item">Work Orders</a>
        </ng-container>
        
        <ng-container *ngIf="hasModule('FINANCE')">
          <div class="nav-section">Finance</div>
          <a routerLink="/invoices" routerLinkActive="active" class="nav-item">Invoices</a>
          <a routerLink="/payments" routerLinkActive="active" class="nav-item">Payments</a>
          <a routerLink="/expense-categories" routerLinkActive="active" class="nav-item">Expense Categories</a>
          <a routerLink="/expenses" routerLinkActive="active" class="nav-item">Expenses</a>
        </ng-container>
        
        <ng-container *ngIf="isAdmin()">
          <div class="nav-section">Settings</div>
          <a routerLink="/users" routerLinkActive="active" class="nav-item">Users</a>
        </ng-container>
      </nav>
    </aside>
    
    <main class="main-content">
      <header class="top-bar">
        <h1 class="page-title">Garage Management System</h1>
        <div class="user-menu" *ngIf="currentUser">
          <span class="username">{{ currentUser.username }}</span>
          <button class="btn-logout" (click)="logout()">Logout</button>
        </div>
      </header>
      <div class="content-area">
        <router-outlet></router-outlet>
      </div>
    </main>
  </div>
</ng-template>
